# Final assignment github repository.

MDGE 610: Foundations of Bioinformatics.

Dorian Rojas Villalta. Ph.D. Student. February 2026

## Overview

This github contains the [written report](Written_report.pdf) and 
[output data](empiricalInvestigation) for the final assignment of MDGE 610: 
Foundations in bioinformatics.

### Contents

| Path | Description |
|------|-------------|
| `assignment_handout.pdf` | Assignment instructions |
| `Written_report.pdf` | Rendered written report |
| `Written_report.qmd` | Source quarto file of written report |
| `log-likelihood_function_kallisto.png` | Figure 1 of written report |
| `empiricalInvestigation/gencode.v44.kidx` | Pre-built kallisto index (GENCODE v44 protein-coding transcripts) |
| `empiricalInvestigation/sim_true_counts.txt` | Ground truth transcript counts |
| `empiricalInvestigation/00-raw-data/sim_reads_1.fastq.gz` | Simulated paired-end reads (read 1) |
| `empiricalInvestigation/00-raw-data/sim_reads_2.fastq.gz` | Simulated paired-end reads (read 2) |

The final written report was generated using Quarto in RStudio and rendered in 
pdf. Both the `.qmd` and `.pdf` documents can be found in this repository. This
contains the answers for each of the questions as well as the methods and respective 
code for the empirical investigation. 

The empirical investigation was conducted on a set of simulated data generated by 
the class professor Dr. Jason de Koning. These files were directly downloaded from the
[assignment repository](https://github.com/jasondk/mdge610-kallisto/tree/main) without git cloning.
Details of simulated data are described below:

### Simulated Data Details

- **Reference**: GENCODE v44 human protein-coding transcriptome (110,962 transcripts)
- **Read pairs**: 1,000,000
- **Read length**: 75 bp paired-end
- **Fragment length**: Mean 250 bp, SD 50 bp
- **Sequencing error**: 1% per-base

## Local installation of kallisto

In order to complete the assignment, the kallisto software was installed locally 
in a MacBook Air with Apple M4 10 cores and 16GB of RAM. The implementation of the 
software was conducted using the following command in the terminal:

  ```bash
  # Installing prerequired tools
  ## Git LFS
  brew install git-lfs
  git lfs install
  
  ## CMake
  brew install cmake
  
  # Installing kallisto software
  ## Cloning repository
  git clone https://github.com/pachterlab/kallisto.git
  cd kallisto
  
  ## Removing incompatibility arguments (x86-only -mno-avx2 flag)
  sed -i '' 's/-mno-avx2//g' ext/bifrost/CMakeLists.txt
  
  ## Fix the DataStorage.tcc typo (see #488)
  sed -i '' 's/o\.sz_link\[i\]\.load()/o.unitig_cs_link[i].load()/' ext/bifrost/src/DataStorage.tcc
  
  ## Configure
  mkdir build && cd build
  CMAKE_POLICY_VERSION_MINIMUM=3.5 cmake .. -DENABLE_AVX2=OFF -DCOMPILATION_ARCH=OFF -DCMAKE_POLICY_VERSION_MINIMUM=3.5
  
  ## Build (|| handles a possible race condition on first run)
  CMAKE_POLICY_VERSION_MINIMUM=3.5 make -j$(sysctl -n hw.ncpu) || make -j$(sysctl -n hw.ncpu)
  
  # Modifying cloned repository origin
  ## Remove original remote location 
  
  ## Adding current repository remote location 
  
  ## Commit and push
  ```
> Note: several modification were made over the installation instructions to fit the
local computer in which was installed. The authors thanks the professor the help
provided over the solution to these issues. To see the original installation instruction
visit the [kallisto GitHub repository](https://github.com/pachterlab/kallisto).

The [kallisto folder](/kallisto/) here stored represents a copy of the original repository 
created for allowing the track changes of the pertinent modification of the convergence 
criteria in the [expectation-maximization (EM) algorithm](/kallisto/src/EMAlgorithm.h)
for the purpose of this assignment.

## Brief assignment methods

This assignment aims to understand the effect of convergence criteria values into
the relative difference between analyzed simulated data and their ground truth. For this
the kallisto EM algorithm was modified as followed:




## Acknowledgement

This assignment is dedicated to David Rojas Rodr√≠guez, who heard the author
talk about expectation-maximization and equivalence classes for over a week. He 
said he enjoyed listening to audio messages about the topic like a podcast while 
doing the dishes.
